# twitchTransFreeNeo デバッグ手順（2025年版）

## 重要事項
- **バイナリビルドはGitHub Actionsで自動実行される**（ローカルビルドは不要）
- バージョン番号は安定版リリース時のみ更新（デバッグ中は変更しない）
- **Fletへの移行により、macOS固有のtkinter問題から解放**

## 技術スタック変更（v0.2.0以降）
- GUI: tkinter → **Flet**（Flutter/Dartベース）
- バイナリ化: PyInstaller → **Nuitka**
- パッケージ管理: pip → **uv**
- 翻訳ライブラリ: async-google-trans-new → **deep-translator**

## デバッグワークフロー
1. コード修正
2. ローカルでテスト実行: `uv run python run.py`
3. 修正をコミット: `git add -A && git commit -m "fix: 説明"`
4. GitHubにプッシュ: `git push origin main`
5. **タグを作成してビルド**: `git tag -a v0.2.0_Beta_debugN -m "説明"` (Nは連番)
6. タグをプッシュ: `git push origin v0.2.0_Beta_debugN`
7. GitHub Actionsでバイナリが自動ビルドされる（タグプッシュで発火）
8. **【重要】ビルド完了後、必ずPre-releaseになっているか確認**
   - https://github.com/sayonari/twitchTransFreeNeo/releases
   - 「Pre-release」ラベルが付いていることを確認
   - 「Latest」になっていないことを確認
   - なっていない場合は手動で「Edit release」→「Set as a pre-release」にチェック
9. ユーザーがバイナリをダウンロードしてテスト
10. フィードバックを受けて修正を繰り返す

## 解決済みの問題
### ✅ macOSでのフォントサイズ変更問題
- **旧問題**: tkinter.fontとmacOS AutoReleasePoolの非互換性によるクラッシュ
- **対策**: Fletへの移行により根本的に解決
- **状態**: 解決完了（v0.2.0以降）

### ✅ ボタン反応性問題（macOS固有）
- **旧問題**: ボタンクリック時の反応が悪い、フォーカスが適切に移動しない
- **対策**: Fletへの移行により根本的に解決
- **状態**: 解決完了（v0.2.0以降）
- **注**: tkinterの問題であり、Fletでは発生しない

## テストポイント
1. GUI起動が正常に動作するか（Flet）
2. 設定画面が正常に開き、設定が保存されるか
3. Twitch接続が正常に動作するか
4. 翻訳機能が正常に動作するか（deep-translator）
5. TTS機能が正常に動作するか
6. ウィンドウのサイズ・位置が保存されるか
7. 各OSで正常にビルドされるか（macOS arm64/x86_64, Windows, Linux）

## 開発Tips
- **パッケージ追加**: `uv add <パッケージ名>`
- **依存関係同期**: `uv sync`
- **ローカル実行**: `uv run python run.py`
- **ローカルビルド**: `uv run python build_nuitka.py` （テスト用、時間がかかる）

## 注意事項
- Fletはウィンドウを開くため、自動テストは困難
- Nuitkaの初回ビルドは1時間以上かかる場合がある（GitHub Actionsでキャッシュを利用）